!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app-compat"),require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app-compat","@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase,t.firebase.INTERNAL.modularAPIs)}(this,function(me,ve){"use strict";try{!(function(){function t(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var e=t(me);class a extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,a.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r.prototype.create)}}class r{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){var r,n=e[0]||{},i=`${this.service}/${t}`,o=this.errors[t],o=o?(r=n,o.replace(s,(t,e)=>{var n=r[e];return null!=n?String(n):`<${e}?>`})):"Error",o=`${this.serviceName}: ${o} (${i}).`;return new a(i,o,n)}}const s=/\{\$([^}]+)}/g;var n,i=(o.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},o.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},o.prototype.setServiceProps=function(t){return this.serviceProps=t,this},o.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},o);function o(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}(_t=n=n||{})[_t.DEBUG=0]="DEBUG",_t[_t.VERBOSE=1]="VERBOSE",_t[_t.INFO=2]="INFO",_t[_t.WARN=3]="WARN",_t[_t.ERROR=4]="ERROR",_t[_t.SILENT=5]="SILENT";const c={debug:n.DEBUG,verbose:n.VERBOSE,info:n.INFO,warn:n.WARN,error:n.ERROR,silent:n.SILENT},u=n.INFO,l={[n.DEBUG]:"log",[n.VERBOSE]:"log",[n.INFO]:"info",[n.WARN]:"warn",[n.ERROR]:"error"},p=(t,e,...n)=>{if(!(e<t.logLevel)){var r=(new Date).toISOString(),i=l[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)}};function f(n){return new Promise(function(t,e){n.onsuccess=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function d(n,r,i){var o,t=new Promise(function(t,e){f(o=n[r].apply(n,i)).then(t,e)});return t.request=o,t}function g(t,n,e){e.forEach(function(e){Object.defineProperty(t.prototype,e,{get:function(){return this[n][e]},set:function(t){this[n][e]=t}})})}function h(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return d(this[n],t,arguments)})})}function m(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return this[n][t].apply(this[n],arguments)})})}function v(t,r,e,n){n.forEach(function(n){n in e.prototype&&(t.prototype[n]=function(){return t=this[r],(e=d(t,n,arguments)).then(function(t){if(t)return new _(t,e.request)});var t,e})})}function b(t){this._index=t}function _(t,e){this._cursor=t,this._request=e}function y(t){this._store=t}function w(n){this._tx=n,this.complete=new Promise(function(t,e){n.oncomplete=function(){t()},n.onerror=function(){e(n.error)},n.onabort=function(){e(n.error)}})}function E(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new w(n)}function I(t){this._db=t}g(b,"_index",["name","keyPath","multiEntry","unique"]),h(b,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),v(b,"_index",IDBIndex,["openCursor","openKeyCursor"]),g(_,"_cursor",["direction","key","primaryKey","value"]),h(_,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(_.prototype[n]=function(){var e=this,t=arguments;return Promise.resolve().then(function(){return e._cursor[n].apply(e._cursor,t),f(e._request).then(function(t){if(t)return new _(t,e._request)})})})}),y.prototype.createIndex=function(){return new b(this._store.createIndex.apply(this._store,arguments))},y.prototype.index=function(){return new b(this._store.index.apply(this._store,arguments))},g(y,"_store",["name","keyPath","indexNames","autoIncrement"]),h(y,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),v(y,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),m(y,"_store",IDBObjectStore,["deleteIndex"]),w.prototype.objectStore=function(){return new y(this._tx.objectStore.apply(this._tx,arguments))},g(w,"_tx",["objectStoreNames","mode"]),m(w,"_tx",IDBTransaction,["abort"]),E.prototype.createObjectStore=function(){return new y(this._db.createObjectStore.apply(this._db,arguments))},g(E,"_db",["name","version","objectStoreNames"]),m(E,"_db",IDBDatabase,["deleteObjectStore","close"]),I.prototype.transaction=function(){return new w(this._db.transaction.apply(this._db,arguments))},g(I,"_db",["name","version","objectStoreNames"]),m(I,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(o){[y,b].forEach(function(t){o in t.prototype&&(t.prototype[o.replace("open","iterate")]=function(){var t,e=(t=arguments,Array.prototype.slice.call(t)),n=e[e.length-1],r=this._store||this._index,i=r[o].apply(r,e.slice(0,-1));i.onsuccess=function(){n(i.result)}})})}),[b,y].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,n){var r=this,i=[];return new Promise(function(e){r.iterateCursor(t,function(t){t?(i.push(t.value),void 0===n||i.length!=n?t.continue():e(i)):e(i)})})})});var T="@firebase/installations",S="0.5.2";const N=1e4,k=`w:${S}`,A="FIS_v2",C="https://firebaseinstallations.googleapis.com/v1",O=36e5;const P=new r("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function R(t){return t instanceof a&&t.code.includes("request-failed")}function M({projectId:t}){return`${C}/projects/${t}/installations`}function j(t){return{token:t.token,requestStatus:2,expiresIn:(t=t.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()}}async function B(t,e){var n=(await e.json()).error;return P.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function D({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function L(t,{refreshToken:e}){const n=D(t);return n.append("Authorization",(e=e,`${A} ${e}`)),n}async function $(t){var e=await t();return 500<=e.status&&e.status<600?t():e}function U(e){return new Promise(t=>{setTimeout(t,e)})}const q=/^[cdef][\w-]{21}$/,x="";function F(){try{const e=new Uint8Array(17),n=self.crypto||self.msCrypto;n.getRandomValues(e),e[0]=112+e[0]%16;var t=function(t){const e=function(t){const e=btoa(String.fromCharCode(...t));return e.replace(/\+/g,"-").replace(/\//g,"_")}(t);return e.substr(0,22)}(e);return q.test(t)?t:x}catch(t){return x}}function H(t){return`${t.appName}!${t.appId}`}const V=new Map;function K(t,e){var n=H(t);W(n,e),function(t,e){const n=function(){!z&&"BroadcastChannel"in self&&(z=new BroadcastChannel("[Firebase] FID Change"),z.onmessage=t=>{W(t.data.key,t.data.fid)});return z}();n&&n.postMessage({key:t,fid:e});0===V.size&&z&&(z.close(),z=null)}(n,e)}function W(t,e){var n=V.get(t);if(n)for(const r of n)r(e)}let z=null;const G="firebase-installations-store";let J=null;function Y(){var e,t,n;return J=J||(e=t=>{0===t.oldVersion&&t.createObjectStore(G)},t=d(indexedDB,"open",["firebase-installations-database",1]),(n=t.request)&&(n.onupgradeneeded=function(t){e&&e(new E(n.result,t.oldVersion,n.transaction))}),t.then(function(t){return new I(t)})),J}async function Z(t,e){var n=H(t);const r=await Y(),i=r.transaction(G,"readwrite"),o=i.objectStore(G);var a=await o.get(n);return await o.put(e,n),await i.complete,a&&a.fid===e.fid||K(t,e.fid),e}async function Q(t){var e=H(t);const n=await Y(),r=n.transaction(G,"readwrite");await r.objectStore(G).delete(e),await r.complete}async function X(t,e){var n=H(t);const r=await Y(),i=r.transaction(G,"readwrite"),o=i.objectStore(G);var a=await o.get(n),s=e(a);return void 0===s?await o.delete(n):await o.put(s,n),await i.complete,!s||a&&a.fid===s.fid||K(t,s.fid),s}async function tt(n){let r;var t=await X(n,t=>{var e=nt(t||{fid:F(),registrationStatus:0}),e=function(t,e){{if(0!==e.registrationStatus)return 1===e.registrationStatus?{installationEntry:e,registrationPromise:async function(t){let e=await et(t);for(;1===e.registrationStatus;)await U(100),e=await et(t);if(0!==e.registrationStatus)return e;{var{installationEntry:n,registrationPromise:r}=await tt(t);return r||n}}(t)}:{installationEntry:e};if(!navigator.onLine){var n=Promise.reject(P.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},n=async function(e,n){try{var t=await async function(t,{fid:e}){const n=M(t);var r=D(t),i={fid:e,authVersion:A,appId:t.appId,sdkVersion:k};const o={method:"POST",headers:r,body:JSON.stringify(i)},a=await $(()=>fetch(n,o));if(a.ok){i=await a.json();return{fid:i.fid||e,registrationStatus:2,refreshToken:i.refreshToken,authToken:j(i.authToken)}}throw await B("Create Installation",a)}(e,n);return Z(e,t)}catch(t){throw R(t)&&409===t.customData.serverCode?await Q(e):await Z(e,{fid:n.fid,registrationStatus:0}),t}}(t,r);return{installationEntry:r,registrationPromise:n}}}(n,e);return r=e.registrationPromise,e.installationEntry});return t.fid===x?{installationEntry:await r}:{installationEntry:t,registrationPromise:r}}function et(t){return X(t,t=>{if(!t)throw P.create("installation-not-found");return nt(t)})}function nt(t){return 1===(e=t).registrationStatus&&e.registrationTime+N<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function rt({appConfig:t,platformLoggerProvider:e},n){const r=([i,o]=[t,n["fid"]],`${M(i)}/${o}/authTokens:generate`);var i,o;const a=L(t,n),s=e.getImmediate({optional:!0});s&&a.append("x-firebase-client",s.getPlatformInfoString());var c={installation:{sdkVersion:k}};const u={method:"POST",headers:a,body:JSON.stringify(c)},l=await $(()=>fetch(r,u));if(l.ok)return j(await l.json());throw await B("Generate Auth Token",l)}async function it(r,i=!1){let o;var t=await X(r.appConfig,t=>{if(!at(t))throw P.create("not-registered");var e,n=t.authToken;if(i||2!==(e=n).requestStatus||function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+O}(e)){if(1===n.requestStatus)return o=async function(t,e){let n=await ot(t.appConfig);for(;1===n.authToken.requestStatus;)await U(100),n=await ot(t.appConfig);var r=n.authToken;return 0===r.requestStatus?it(t,e):r}(r,i),t;if(!navigator.onLine)throw P.create("app-offline");n=(e=t,n={requestStatus:1,requestTime:Date.now()},Object.assign(Object.assign({},e),{authToken:n}));return o=async function(e,n){try{var r=await rt(e,n),t=Object.assign(Object.assign({},n),{authToken:r});return await Z(e.appConfig,t),r}catch(t){throw!R(t)||401!==t.customData.serverCode&&404!==t.customData.serverCode?(r=Object.assign(Object.assign({},n),{authToken:{requestStatus:0}}),await Z(e.appConfig,r)):await Q(e.appConfig),t}}(r,n),n}return t});return o?await o:t.authToken}function ot(t){return X(t,t=>{if(!at(t))throw P.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+N<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t})}function at(t){return void 0!==t&&2===t.registrationStatus}async function st(t,e=!1){var n,r=t;return t=r.appConfig,await((n=(await tt(t)).registrationPromise)&&await n),(await it(r,e)).token}function ct(t){return P.create("missing-app-config-values",{valueName:t})}const ut="installations",lt=t=>{var e=t.getProvider("app").getImmediate();return{app:e,appConfig:function(t){if(!t||!t.options)throw ct("App Configuration");if(!t.name)throw ct("App Name");for(const e of["projectId","apiKey","appId"])if(!t.options[e])throw ct(e);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:ve._getProvider(e,"platform-logger"),_delete:()=>Promise.resolve()}},pt=t=>{var e=t.getProvider("app").getImmediate();const n=ve._getProvider(e,ut).getImmediate();return{getId:()=>async function(t){var e=t;const{installationEntry:n,registrationPromise:r}=await tt(e.appConfig);return(r||it(e)).catch(console.error),n.fid}(n),getToken:t=>st(n,t)}};ve._registerComponent(new i(ut,lt,"PUBLIC")),ve._registerComponent(new i("installations-internal",pt,"PRIVATE")),ve.registerVersion(T,S),ve.registerVersion(T,S,"esm2017");const ft="@firebase/performance",dt="0.5.2",gt=dt,ht="FB-PERF-TRACE-MEASURE",mt="@firebase/performance/config",vt="@firebase/performance/configexpire";var bt,_t,yt,S="Performance";const wt=new r("performance",S,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),Et=new class{constructor(t){this.name=t,this._logLevel=u,this._logHandler=p,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in n))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?c[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,n.DEBUG,...t),this._logHandler(this,n.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,n.VERBOSE,...t),this._logHandler(this,n.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,n.INFO,...t),this._logHandler(this,n.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,n.WARN,...t),this._logHandler(this,n.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,n.ERROR,...t),this._logHandler(this,n.ERROR,...t)}}(S);Et.logLevel=n.INFO;let It,Tt;class St{constructor(t){if(!(this.window=t))throw wt.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(t){this.performance&&this.performance.mark&&this.performance.mark(t)}measure(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)}getEntriesByType(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]}getEntriesByName(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&"undefined"!=typeof navigator&&navigator.cookieEnabled?"object"==typeof indexedDB||(Et.info("IndexedDB is not supported by current browswer"),!1):(Et.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(t,n){if(this.PerformanceObserver){const e=new this.PerformanceObserver(t=>{for(const e of t.getEntries())n(e)});e.observe({entryTypes:[t]})}}static getInstance(){return void 0===It&&(It=new St(Tt)),It}}let Nt;function kt(t,e){var n=t.length-e.length;if(n<0||1<n)throw wt.create("invalid String merger input");const r=[];for(let i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}let At;class Ct{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=kt("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=kt("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===At&&(At=new Ct),At}}(_t=bt=bt||{})[_t.UNKNOWN=0]="UNKNOWN",_t[_t.VISIBLE=1]="VISIBLE",_t[_t.HIDDEN=2]="HIDDEN";const Ot=["firebase_","google_","ga_"],Pt=new RegExp("^[a-zA-Z]\\w*$");function Rt(){switch(St.getInstance().document.visibilityState){case"visible":return bt.VISIBLE;case"hidden":return bt.HIDDEN;default:return bt.UNKNOWN}}function Mt(t){var e=null===(e=t.options)||void 0===e?void 0:e.appId;if(!e)throw wt.create("no app id");return e}const jt="0.0.1",Bt={loggingEnabled:!0},Dt="FIREBASE_INSTALLATIONS_AUTH";function Lt(t,e){var r,i,n=function(){const t=St.getInstance().localStorage;if(t){var e=t.getItem(vt);if(e&&function(t){return Number(t)>Date.now()}(e)){e=t.getItem(mt);if(e)try{return JSON.parse(e)}catch(t){return}}}}();return n?(Ut(n),Promise.resolve()):(i=e,function(t){const e=t.getToken();return e.then(t=>{}),e}((r=t).installations).then(t=>{var e=function(t){var e=null===(e=t.options)||void 0===e?void 0:e.projectId;if(!e)throw wt.create("no project id");return e}(r.app),n=function(t){var e=null===(e=t.options)||void 0===e?void 0:e.apiKey;if(!e)throw wt.create("no api key");return e}(r.app),n=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${e}/namespaces/fireperf:fetch?key=${n}`,{method:"POST",headers:{Authorization:`${Dt} ${t}`},body:JSON.stringify({app_instance_id:i,app_instance_id_token:t,app_id:Mt(r.app),app_version:gt,sdk_version:jt})});return fetch(n).then(t=>{if(t.ok)return t.json();throw wt.create("RC response not ok")})}).catch(()=>{Et.info($t)}).then(Ut).then(t=>function(t){const e=St.getInstance().localStorage;t&&e&&(e.setItem(mt,JSON.stringify(t)),e.setItem(vt,String(Date.now()+60*Ct.getInstance().configTimeToLive*60*1e3)))}(t),()=>{}))}const $t="Could not fetch config, will use default configs";function Ut(t){if(!t)return t;const e=Ct.getInstance();var n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=Bt.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=qt(e.tracesSamplingRate),e.logNetworkAfterSampling=qt(e.networkRequestsSamplingRate),t}function qt(t){return Math.random()<=t}let xt=1,Ft;function Ht(t){var e;return xt=2,Ft=Ft||(e=t,function(){const n=St.getInstance().document;return new Promise(t=>{if(n&&"complete"!==n.readyState){const e=()=>{"complete"===n.readyState&&(n.removeEventListener("readystatechange",e),t())};n.addEventListener("readystatechange",e)}else t()})}().then(()=>function(t){const e=t.getId();return e.then(t=>{Nt=t}),e}(e.installations)).then(t=>Lt(e,t)).then(()=>Vt(),()=>Vt())),Ft}function Vt(){xt=3}const Kt=1e4,Wt=3,zt=1e3;let Gt=Wt,Jt=[],Yt=!1;function Zt(t){setTimeout(()=>{if(0!==Gt)return Jt.length?void function(){const t=Jt.splice(0,zt),e=t.map(t=>({source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Ct.getInstance().logSource,log_event:e};!function(t,r){return function(t){var e=Ct.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then(t=>(t.ok||Et.info("Call to Firebase backend failed."),t.json())).then(t=>{var e=Number(t.nextRequestWaitMillis);let n=Kt;isNaN(e)||(n=Math.max(e,n));e=t.logResponseDetails;Array.isArray(e)&&0<e.length&&"RETRY_REQUEST_LATER"===e[0].responseAction&&(Jt=[...r,...Jt],Et.info("Retry transport request later.")),Gt=Wt,Zt(n)})}(n,t).catch(()=>{Jt=[...t,...Jt],Gt--,Et.info(`Tries left: ${Gt}.`),Zt(Kt)})}():Zt(Kt)},t)}function Qt(e){return(...t)=>{!function(t){if(!t.eventTime||!t.message)throw wt.create("invalid cc log");Jt=[...Jt,t]}({message:e(...t),eventTime:Date.now()})}}let Xt;function te(t,e){Xt=Xt||Qt(re),Xt(t,e)}function ee(t){var e=Ct.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&St.getInstance().requiredApisAvailable()&&(t.isAuto&&Rt()!==bt.VISIBLE||(3===xt?ne(t):Ht(t.performanceController).then(()=>ne(t),()=>ne(t))))}function ne(t){var e;!Nt||(e=Ct.getInstance()).loggingEnabled&&e.logTraceAfterSampling&&setTimeout(()=>te(t,1),0)}function re(t,e){return 0===e?(n={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:ie(t.performanceController.app),network_request_metric:n},JSON.stringify(n)):function(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);n={application_info:ie(t.performanceController.app),trace_metric:e};return JSON.stringify(n)}(t);var n}function ie(t){return{google_app_id:Mt(t),app_instance_id:Nt,web_app_info:{sdk_version:gt,page_url:St.getInstance().getUrl(),service_worker_status:"serviceWorker"in(e=St.getInstance().navigator)?e.serviceWorker.controller?2:3:1,visibility_state:Rt(),effective_connection_type:function(){var t=St.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0};var e}const oe=["_fp","_fcp","_fid"];class ae{constructor(t,e,n=!1,r){this.performanceController=t,this.name=e,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=St.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`${ht}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw wt.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw wt.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),ee(this)}record(t,e,n){if(t<=0)throw wt.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw wt.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Object.assign({},n.attributes)),n&&n.metrics)for(const r of Object.keys(n.metrics))isNaN(Number(n.metrics[r]))||(this.counters[r]=Number(Math.floor(n.metrics[r])));ee(this)}incrementMetric(t,e=1){void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)}putMetric(t,e){if(r=t,i=this.name,0===r.length||100<r.length||!(i&&i.startsWith("_wt_")&&-1<oe.indexOf(r))&&r.startsWith("_"))throw wt.create("invalid custom metric name",{customMetricName:t});var n,r,i;this.counters[t]=(e=e,(n=Math.floor(e))<e&&Et.info(`Metric value should be an Integer, setting the value as : ${n}.`),n)}getMetric(t){return this.counters[t]||0}putAttribute(t,e){var n,r,i=!(0===(n=t).length||40<n.length)&&(!Ot.some(t=>n.startsWith(t))&&!!n.match(Pt)),o=0!==(r=e).length&&r.length<=100;if(i&&o)this.customAttributes[t]=e;else{if(!i)throw wt.create("invalid attribute name",{attributeName:t});if(!o)throw wt.create("invalid attribute value",{attributeValue:e})}}getAttribute(t){return this.customAttributes[t]}removeAttribute(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(t){this.startTimeUs=t}setDuration(t){this.durationUs=t}calculateTraceMetrics(){var t=this.api.getEntriesByName(this.traceMeasure),t=t&&t[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(t,e,n,r){var i=St.getInstance().getUrl();if(i){const o=new ae(t,"_wt_"+i,!0);i=Math.floor(1e3*St.getInstance().getTimeOrigin());o.setStartTime(i),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));n&&((i=n.find(t=>"first-paint"===t.name))&&i.startTime&&o.putMetric("_fp",Math.floor(1e3*i.startTime)),(i=n.find(t=>"first-contentful-paint"===t.name))&&i.startTime&&o.putMetric("_fcp",Math.floor(1e3*i.startTime)),r&&o.putMetric("_fid",Math.floor(1e3*r))),ee(o)}}static createUserTimingTrace(t,e){ee(new ae(t,e,!1,e))}}function se(t,e){const n=e;var r,i,o;n&&void 0!==n.responseStart&&(o=St.getInstance().getTimeOrigin(),r=Math.floor(1e3*(n.startTime+o)),i=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime)),function(t){const e=Ct.getInstance();var n,r,i;e.instrumentationEnabled&&(n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0],n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(()=>te(t,0),0))}({performanceController:t,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o}))}const ce=5e3;function ue(t){Nt&&(setTimeout(()=>function(n){const t=St.getInstance(),r=t.getEntriesByType("navigation"),i=t.getEntriesByType("paint");if(t.onFirstInputDelay){let e=setTimeout(()=>{ae.createOobTrace(n,r,i),e=void 0},ce);t.onFirstInputDelay(t=>{e&&(clearTimeout(e),ae.createOobTrace(n,r,i,t))})}else ae.createOobTrace(n,r,i)}(t),0),setTimeout(()=>function(e){const t=St.getInstance(),n=t.getEntriesByType("resource");for(const r of n)se(e,r);t.setupObserver("resource",t=>se(e,t))}(t),0),setTimeout(()=>function(e){const t=St.getInstance(),n=t.getEntriesByType("measure");for(const r of n)le(e,r);t.setupObserver("measure",t=>le(e,t))}(t),0))}function le(t,e){const n=e.name;n.substring(0,ht.length)!==ht&&ae.createUserTimingTrace(t,n)}class pe{constructor(t,e){this.app=t,this.installations=e,this.initialized=!1}_init(t){this.initialized||(void 0!==(null==t?void 0:t.dataCollectionEnabled)&&(this.dataCollectionEnabled=t.dataCollectionEnabled),void 0!==(null==t?void 0:t.instrumentationEnabled)&&(this.instrumentationEnabled=t.instrumentationEnabled),St.getInstance().requiredApisAvailable()?new Promise((e,n)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var t;n((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){n(t)}}).then(t=>{t&&(Yt||(Zt(5500),Yt=!0),Ht(this).then(()=>ue(this),()=>ue(this)),this.initialized=!0)}).catch(t=>{Et.info(`Environment doesn't support IndexedDB: ${t}`)}):Et.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(t){Ct.getInstance().instrumentationEnabled=t}get instrumentationEnabled(){return Ct.getInstance().instrumentationEnabled}set dataCollectionEnabled(t){Ct.getInstance().dataCollectionEnabled=t}get dataCollectionEnabled(){return Ct.getInstance().dataCollectionEnabled}}const fe="[DEFAULT]";const de=(t,{options:e})=>{var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations-internal").getImmediate();if(n.name!==fe)throw wt.create("FB not default");if("undefined"==typeof window)throw wt.create("no window");t=window,Tt=t;const i=new pe(n,r);return i._init(e),i};ve._registerComponent(new i("performance",de,"PUBLIC")),ve.registerVersion(ft,dt),ve.registerVersion(ft,dt,"esm2017");class ge{constructor(t,e){this.app=t,this._delegate=e}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(t){this._delegate.instrumentationEnabled=t}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(t){this._delegate.dataCollectionEnabled=t}trace(t){return e=this._delegate,n=t,e=(t=e)&&t._delegate?t._delegate:t,new ae(e,n);var e,n}}function he(t){var e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new ge(e,n)}(yt=e.default).INTERNAL.registerComponent(new i("performance-compat",he,"PUBLIC")),yt.registerVersion("@firebase/performance-compat","0.1.2")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-performance-compat.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-performance-compat.js.map
